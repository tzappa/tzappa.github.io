<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Heart Rate Calculator & Zones - Tzappa's GitHub Pages</title>
    <link rel="stylesheet" href="running-time-table.css">
    <style>
        /* Heart Rate Zone Colors */
        .zone1 { background-color: rgba(34, 197, 94, 0.2); color: #eee; font-weight: 500; }
        .zone2 { background-color: rgba(234, 179, 8, 0.2); color: #eee; font-weight: 500; }
        .zone3 { background-color: rgba(249, 115, 22, 0.2); color: #eee; font-weight: 500; }
        .zone4 { background-color: rgba(239, 68, 68, 0.2); color: #eee; font-weight: 500; }
        .zone5 { background-color: rgba(220, 38, 38, 0.3); color: #eee; font-weight: 500; }
    </style>
</head>
<body>
    <main class="calculator-container">
        <div class="content-wrapper">
            <header>
                <h1 class="main-title">Heart Rate Calculator & Zones</h1>
                <p class="section-title" style="text-align: center; margin-top: -1rem;">Calculate your maximum heart rate and personalized training zones</p>
            </header>

            <div class="calculator-layout">
                <section class="calculator-form-section">
                    <article class="card">
                        <h2 class="section-title">Maximum Heart Rate Calculator</h2>
                        <div class="form-container">
                            <p>Calculate your maximum heart rate using various research-based formulas:</p>
                            <div class="form-group">
                                <label for="formula">Select formula:</label>
                                <select id="formula" class="form-control">
                                    <option value="wingate">Wingate (2015)</option>
                                    <option value="nes">Nes (2013)</option>
                                    <option value="oakland">Oakland University (2007)</option>
                                    <option value="tanaka">Tanaka, Monahan & Seals (2001)</option>
                                    <option value="inbar">Inbar (1994)</option>
                                    <option value="haskell">Haskell & Fox (1971)</option>
                                </select>
                            </div>
                            <div class="form-group">
                                <label for="sex">Select your sex:</label>
                                <select id="sex" class="form-control">
                                    <option value="">Select sex</option>
                                    <option value="male">Male</option>
                                    <option value="female">Female</option>
                                </select>
                            </div>
                            <div class="form-group">
                                <label for="age">Enter your age:</label>
                                <input type="number" id="age" class="form-control" min="1" max="120" placeholder="Enter age">
                            </div>
                            <div id="formulaDescription" class="formula-description" style="margin-top: 1rem; padding: 0.75rem; background: rgba(59, 130, 246, 0.1); border-radius: 6px; border-left: 3px solid #3b82f6; font-size: 0.9rem;">
                                <strong>Selected Formula:</strong> <span id="formulaText">Wingate (2015) - Males: 208.609 - (0.716 × age), Females: 209.273 - (0.804 × age)</span>
                            </div>
                            <button onclick="calculateHeartRate()" class="calculate-button">Calculate Maximum Heart Rate</button>
                            <div id="result" class="result" style="display: none;">
                                <div class="result-title">Your Maximum Heart Rate</div>
                                <div class="result-value" id="heartRateResult"></div>
                                <div style="margin-top: 1rem; font-size: 0.9rem; color: #d1d5db;">
                                    <p><strong>Note:</strong> This is an estimate. Individual variations may occur.</p>
                                    <p>Consult with healthcare professionals for personalized advice.</p>
                                </div>
                            </div>
                        </div>
                    </article>
                </section>

                <section class="calculator-form-section">
                    <article class="card">
                        <h2 class="section-title">Heart Rate Zones Calculator</h2>
                        <div class="form-container">
                            <p>Calculate your personalized heart rate training zones using different methods:</p>
                            
                            <div class="form-group">
                                <label for="zoneMethod">Select calculation method:</label>
                                <select id="zoneMethod" class="form-control">
                                    <option value="mhr">Max Heart Rate Method</option>
                                    <option value="karvonen">Karvonen Method (MHR - RHR)</option>
                                </select>
                            </div>

                            <div id="mhrMethod" class="method-section">
                                <div class="form-group">
                                    <label for="maxHR">Enter your Maximum Heart Rate (bpm):</label>
                                    <input type="number" id="maxHR" class="form-control" min="100" max="220" placeholder="Enter Max HR">
                                    <small style="color: #9ca3af; font-size: 0.8rem;">Use the calculator above to determine your Max HR</small>
                                </div>
                            </div>

                            <div id="karvonenMethod" class="method-section" style="display: none;">
                                <div class="form-group">
                                    <label for="karvonenMaxHR">Maximum Heart Rate (bpm):</label>
                                    <input type="number" id="karvonenMaxHR" class="form-control" min="100" max="220" placeholder="Enter Max HR">
                                </div>
                                <div class="form-group">
                                    <label for="restHR">Resting Heart Rate (bpm):</label>
                                    <input type="number" id="restHR" class="form-control" min="30" max="100" placeholder="Enter Rest HR">
                                    <small style="color: #9ca3af; font-size: 0.8rem;">Measure your resting heart rate first thing in the morning</small>
                                </div>
                            </div>

                            <button onclick="calculateZones()" class="calculate-button">Calculate Heart Rate Zones</button>
                            
                            <div id="zonesResult" class="result" style="display: none;">
                                <div class="result-title">Your Heart Rate Training Zones</div>
                                <div id="zonesContent" class="zones-content"></div>
                            </div>
                        </div>
                    </article>
                </section>

                <section class="time-table-section">
                    <article class="card">
                        <h2 class="section-title">Heart Rate Zones Reference Table (based on maximum heart rate)</h2>
                        <div class="time-table">
                            <table>
                                <thead id="tableHeader">
                                    <tr>
                                        <th rowspan="2">Age</th>
                                        <th rowspan="2" id="sexHeader" style="display: table-cell;">Sex</th>
                                        <th rowspan="2">Maximum Heart Rate (bpm)</th>
                                        <th>Zone 1 (51-60%)</th>
                                        <th>Zone 2 (61-70%)</th>
                                        <th>Zone 3 (71-80%)</th>
                                        <th>Zone 4 (81-90%)</th>
                                        <th>Zone 5 (91-100%)</th>
                                    </tr>
                                    <tr>
                                        <th style="font-size: 0.8rem; font-weight: 400; color: #9ca3af; padding-top: 0;">Recovery/Easy</th>
                                        <th style="font-size: 0.8rem; font-weight: 400; color: #9ca3af; padding-top: 0;">Aerobic Base</th>
                                        <th style="font-size: 0.8rem; font-weight: 400; color: #9ca3af; padding-top: 0;">Aerobic Threshold</th>
                                        <th style="font-size: 0.8rem; font-weight: 400; color: #9ca3af; padding-top: 0;">Lactate Threshold</th>
                                        <th style="font-size: 0.8rem; font-weight: 400; color: #9ca3af; padding-top: 0;">Neuromuscular Power</th>
                                    </tr>
                                </thead>
                                <tbody id="heartRateTable">
                                    <!-- Table will be populated by JavaScript -->
                                </tbody>
                            </table>
                        </div>
                    </article>
                </section>
            </div>

            <footer style="margin-top: 4rem; text-align: center; font-size: 0.9rem; opacity: 0.7;">
                <p><a href="index.html" style="color: white; text-decoration: none;">← Back to Home</a> | &copy; 2025 Tzappa</p>
            </footer>
        </div>
    </main>

    <script>
        // Heart Rate Zones Calculator Functions
        function calculateZones() {
            const method = document.getElementById('zoneMethod').value;
            let zones = [];

            if (method === 'mhr') {
                const maxHR = document.getElementById('maxHR').value;
                if (!maxHR || maxHR < 100 || maxHR > 220) {
                    alert('Please enter a valid maximum heart rate between 100 and 220 bpm');
                    return;
                }
                zones = calculateMHRZones(parseInt(maxHR));
            } else if (method === 'karvonen') {
                const maxHR = document.getElementById('karvonenMaxHR').value;
                const restHR = document.getElementById('restHR').value;
                
                if (!maxHR || maxHR < 100 || maxHR > 220) {
                    alert('Please enter a valid maximum heart rate between 100 and 220 bpm');
                    return;
                }
                if (!restHR || restHR < 30 || restHR > 100) {
                    alert('Please enter a valid resting heart rate between 30 and 100 bpm');
                    return;
                }
                if (parseInt(restHR) >= parseInt(maxHR)) {
                    alert('Resting heart rate must be lower than maximum heart rate');
                    return;
                }
                zones = calculateKarvonenZones(parseInt(maxHR), parseInt(restHR));
            }

            displayZones(zones, method);
        }

        function calculateMHRZones(maxHR) {
            return [
                { name: 'Zone 1 - Recovery', min: Math.round(maxHR * 0.50), max: Math.round(maxHR * 0.60), description: 'Active Recovery & Warm-up' },
                { name: 'Zone 2 - Aerobic Base', min: Math.round(maxHR * 0.60), max: Math.round(maxHR * 0.70), description: 'Fat Burning & Endurance' },
                { name: 'Zone 3 - Aerobic', min: Math.round(maxHR * 0.70), max: Math.round(maxHR * 0.80), description: 'Aerobic Capacity' },
                { name: 'Zone 4 - Threshold', min: Math.round(maxHR * 0.80), max: Math.round(maxHR * 0.90), description: 'Lactate Threshold' },
                { name: 'Zone 5 - VO2 Max', min: Math.round(maxHR * 0.90), max: Math.round(maxHR * 1.00), description: 'Neuromuscular Power' }
            ];
        }

        function calculateKarvonenZones(maxHR, restHR) {
            const heartRateReserve = maxHR - restHR;
            return [
                { name: 'Zone 1 - Recovery', min: Math.round(restHR + (heartRateReserve * 0.50)), max: Math.round(restHR + (heartRateReserve * 0.60)), description: 'Active Recovery & Warm-up' },
                { name: 'Zone 2 - Aerobic Base', min: Math.round(restHR + (heartRateReserve * 0.60)), max: Math.round(restHR + (heartRateReserve * 0.70)), description: 'Fat Burning & Endurance' },
                { name: 'Zone 3 - Aerobic', min: Math.round(restHR + (heartRateReserve * 0.70)), max: Math.round(restHR + (heartRateReserve * 0.80)), description: 'Aerobic Capacity' },
                { name: 'Zone 4 - Threshold', min: Math.round(restHR + (heartRateReserve * 0.80)), max: Math.round(restHR + (heartRateReserve * 0.90)), description: 'Lactate Threshold' },
                { name: 'Zone 5 - VO2 Max', min: Math.round(restHR + (heartRateReserve * 0.90)), max: Math.round(restHR + (heartRateReserve * 1.00)), description: 'Neuromuscular Power' }
            ];
        }

        function displayZones(zones, method) {
            const zonesContent = document.getElementById('zonesContent');
            const methodText = method === 'mhr' ? 'Max Heart Rate Method' : 'Karvonen Method (MHR - RHR)';
            
            let html = `<div style="margin-bottom: 1rem; padding: 0.75rem; background: rgba(59, 130, 246, 0.1); border-radius: 6px; border-left: 3px solid #3b82f6;">
                <strong>Calculation Method:</strong> ${methodText}
            </div>`;
            
            html += '<div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 1rem;">';
            
            zones.forEach((zone, index) => {
                // Colors matching the visual guide: Recovery (light green), Endurance (light yellow), Aerobic (light orange), Anaerobic (light red), Maximum (solid red)
                const zoneColors = [
                    { bg: 'rgba(34, 197, 94, 0.2)', border: '#22c55e'}, // Recovery - Light Green
                    { bg: 'rgba(234, 179, 8, 0.2)', border: '#eab308'}, // Endurance - Light Yellow
                    { bg: 'rgba(249, 115, 22, 0.2)', border: '#f97316'}, // Aerobic - Light Orange
                    { bg: 'rgba(239, 68, 68, 0.2)', border: '#ef4444'}, // Anaerobic - Light Red
                    { bg: 'rgba(220, 38, 38, 0.3)', border: '#dc2626'}  // Maximum - Solid Red
                ];
                const color = zoneColors[index];
                html += `
                    <div style="padding: 1rem; background: ${color.bg}; border-radius: 8px; border-left: 4px solid ${color.border};">
                        <div style="font-weight: 600; color: ${color.text}; margin-bottom: 0.5rem;">${zone.name}</div>
                        <div style="font-size: 1.2rem; font-weight: 700; margin-bottom: 0.25rem;">${zone.min} - ${zone.max} bpm</div>
                        <div style="font-size: 0.9rem; color: #d1d5db; margin-bottom: 0.5rem;">${zone.description}</div>
                        <div style="font-size: 0.8rem; color: #9ca3af;">${Math.round((zone.min / (method === 'mhr' ? document.getElementById('maxHR').value : document.getElementById('karvonenMaxHR').value)) * 100)}% - ${Math.round((zone.max / (method === 'mhr' ? document.getElementById('maxHR').value : document.getElementById('karvonenMaxHR').value)) * 100)}% of Max HR</div>
                    </div>
                `;
            });
            
            html += '</div>';
            zonesContent.innerHTML = html;
            document.getElementById('zonesResult').style.display = 'block';
        }

        function toggleZoneMethod() {
            const method = document.getElementById('zoneMethod').value;
            const mhrMethod = document.getElementById('mhrMethod');
            const karvonenMethod = document.getElementById('karvonenMethod');
            
            if (method === 'mhr') {
                mhrMethod.style.display = 'block';
                karvonenMethod.style.display = 'none';
            } else {
                mhrMethod.style.display = 'none';
                karvonenMethod.style.display = 'block';
            }
        }

        function transferMaxHR() {
            const maxHRResult = document.getElementById('heartRateResult').textContent;
            if (maxHRResult && maxHRResult.includes('bpm')) {
                const maxHR = maxHRResult.replace(' bpm', '');
                document.getElementById('maxHR').value = maxHR;
                document.getElementById('karvonenMaxHR').value = maxHR;
            }
        }

        // Maximum Heart Rate Calculator Functions
        function calculateHeartRate() {
            const age = document.getElementById('age').value;
            const sex = document.getElementById('sex').value;
            const formula = document.getElementById('formula').value;
            
            if (!age || age < 1 || age > 120) {
                alert('Please enter a valid age between 1 and 120');
                return;
            }
            
            // Only require sex for formulas that need it
            const needsSex = formula === 'wingate';
            if (needsSex && !sex) {
                alert('Please select your sex');
                return;
            }

            let maxHeartRate = calculateMaxHeartRate(age, sex, formula);
            const result = Math.round(maxHeartRate);
            
            document.getElementById('heartRateResult').textContent = result + ' bpm';
            document.getElementById('result').style.display = 'block';
            
            // Transfer result to zones calculator
            transferMaxHR();
        }

        function calculateMaxHeartRate(age, sex, formula) {
            switch(formula) {
                case 'wingate':
                    return sex === 'male' ? 208.609 - (0.716 * age) : 209.273 - (0.804 * age);
                case 'haskell':
                    return 220 - age;
                case 'inbar':
                    return 205.8 - (0.685 * age);
                case 'tanaka':
                    return 208 - (0.7 * age);
                case 'oakland':
                    return 192 - (0.007 * age * age);
                case 'nes':
                    return 211 - (0.64 * age);
                default:
                    return sex === 'male' ? 208.609 - (0.716 * age) : 209.273 - (0.804 * age);
            }
        }

        function updateFormulaDescription() {
            const formula = document.getElementById('formula').value;
            const sex = document.getElementById('sex').value;
            const formulaText = document.getElementById('formulaText');
            const sexGroup = document.getElementById('sex').closest('.form-group');
            
            let description = '';
            let needsSex = false;
            
            switch(formula) {
                case 'wingate':
                    description = 'Wingate (2015) - Males: 208.609 - (0.716 × age), Females: 209.273 - (0.804 × age)';
                    needsSex = true;
                    break;
                case 'haskell':
                    description = 'Haskell & Fox (1971) - 220 - age';
                    needsSex = false;
                    break;
                case 'inbar':
                    description = 'Inbar (1994) - 205.8 - (0.685 × age)';
                    needsSex = false;
                    break;
                case 'tanaka':
                    description = 'Tanaka, Monahan & Seals (2001) - 208 - (0.7 × age)';
                    needsSex = false;
                    break;
                case 'oakland':
                    description = 'Oakland University (2007) - 192 - (0.007 × age²)';
                    needsSex = false;
                    break;
                case 'nes':
                    description = 'Nes (2013) - 211 - (0.64 × age)';
                    needsSex = false;
                    break;
                default:
                    description = 'Wingate (2015) - Males: 208.609 - (0.716 × age), Females: 209.273 - (0.804 × age)';
                    needsSex = true;
            }
            
            formulaText.textContent = description;
            
            // Show/hide sex selector based on formula
            if (needsSex) {
                sexGroup.style.display = 'block';
            } else {
                sexGroup.style.display = 'none';
                // Clear sex selection when not needed
                document.getElementById('sex').value = '';
            }
        }

        function populateTable() {
            const tableBody = document.getElementById('heartRateTable');
            const sexHeader = document.getElementById('sexHeader');
            tableBody.innerHTML = '';

            // Get current formula selection
            const formula = document.getElementById('formula').value;
            const needsSex = formula === 'wingate';

            // Show/hide sex column header
            if (needsSex) {
                sexHeader.style.display = 'table-cell';
            } else {
                sexHeader.style.display = 'none';
            }

            for (let age = 20; age <= 70; age += 5) {
                if (needsSex) {
                    // Calculate for both male and female using Wingate formula
                    const maleMaxHR = calculateMaxHeartRate(age, 'male', 'wingate');
                    const femaleMaxHR = calculateMaxHeartRate(age, 'female', 'wingate');
                    
                    const roundedMaleMaxHR = Math.round(maleMaxHR);
                    const roundedFemaleMaxHR = Math.round(femaleMaxHR);
                    
                    // Calculate heart rate zones for male
                    const maleZone1Min = Math.round(roundedMaleMaxHR * 0.51);
                    const maleZone1Max = Math.round(roundedMaleMaxHR * 0.60);
                    const maleZone2Min = Math.round(roundedMaleMaxHR * 0.61);
                    const maleZone2Max = Math.round(roundedMaleMaxHR * 0.70);
                    const maleZone3Min = Math.round(roundedMaleMaxHR * 0.71);
                    const maleZone3Max = Math.round(roundedMaleMaxHR * 0.80);
                    const maleZone4Min = Math.round(roundedMaleMaxHR * 0.81);
                    const maleZone4Max = Math.round(roundedMaleMaxHR * 0.90);
                    const maleZone5Min = Math.round(roundedMaleMaxHR * 0.91);
                    const maleZone5Max = Math.round(roundedMaleMaxHR * 1.00);

                    // Calculate heart rate zones for female
                    const femaleZone1Min = Math.round(roundedFemaleMaxHR * 0.51);
                    const femaleZone1Max = Math.round(roundedFemaleMaxHR * 0.60);
                    const femaleZone2Min = Math.round(roundedFemaleMaxHR * 0.61);
                    const femaleZone2Max = Math.round(roundedFemaleMaxHR * 0.70);
                    const femaleZone3Min = Math.round(roundedFemaleMaxHR * 0.71);
                    const femaleZone3Max = Math.round(roundedFemaleMaxHR * 0.80);
                    const femaleZone4Min = Math.round(roundedFemaleMaxHR * 0.81);
                    const femaleZone4Max = Math.round(roundedFemaleMaxHR * 0.90);
                    const femaleZone5Min = Math.round(roundedFemaleMaxHR * 0.91);
                    const femaleZone5Max = Math.round(roundedFemaleMaxHR * 1.00);

                    // Create male row
                    const maleRow = document.createElement('tr');
                    maleRow.innerHTML = `
                        <td style="font-weight: 500;">${age}</td>
                        <td style="font-weight: 500; color: #3b82f6;">Male</td>
                        <td style="color: #f25050; font-weight: 600;">${roundedMaleMaxHR}</td>
                        <td class="zone1">${maleZone1Min} - ${maleZone1Max}</td>
                        <td class="zone2">${maleZone2Min} - ${maleZone2Max}</td>
                        <td class="zone3">${maleZone3Min} - ${maleZone3Max}</td>
                        <td class="zone4">${maleZone4Min} - ${maleZone4Max}</td>
                        <td class="zone5">${maleZone5Min} - ${maleZone5Max}</td>
                    `;
                    tableBody.appendChild(maleRow);

                    // Create female row
                    const femaleRow = document.createElement('tr');
                    femaleRow.innerHTML = `
                        <td style="font-weight: 500;">${age}</td>
                        <td style="font-weight: 500; color: #ec4899;">Female</td>
                        <td style="color: #f25050; font-weight: 600;">${roundedFemaleMaxHR}</td>
                        <td class="zone1">${femaleZone1Min} - ${femaleZone1Max}</td>
                        <td class="zone2">${femaleZone2Min} - ${femaleZone2Max}</td>
                        <td class="zone3">${femaleZone3Min} - ${femaleZone3Max}</td>
                        <td class="zone4">${femaleZone4Min} - ${femaleZone4Max}</td>
                        <td class="zone5">${femaleZone5Min} - ${femaleZone5Max}</td>
                    `;
                    tableBody.appendChild(femaleRow);
                } else {
                    // Calculate using universal formula (no sex needed)
                    const maxHR = calculateMaxHeartRate(age, '', formula);
                    const roundedMaxHR = Math.round(maxHR);
                    
                    // Calculate heart rate zones
                    const zone1Min = Math.round(roundedMaxHR * 0.51);
                    const zone1Max = Math.round(roundedMaxHR * 0.60);
                    const zone2Min = Math.round(roundedMaxHR * 0.61);
                    const zone2Max = Math.round(roundedMaxHR * 0.70);
                    const zone3Min = Math.round(roundedMaxHR * 0.71);
                    const zone3Max = Math.round(roundedMaxHR * 0.80);
                    const zone4Min = Math.round(roundedMaxHR * 0.81);
                    const zone4Max = Math.round(roundedMaxHR * 0.90);
                    const zone5Min = Math.round(roundedMaxHR * 0.91);
                    const zone5Max = Math.round(roundedMaxHR * 1.00);

                    // Create single row
                    const row = document.createElement('tr');
                    row.innerHTML = `
                        <td style="font-weight: 500;">${age}</td>
                        <td style="color: #f25050; font-weight: 600;">${roundedMaxHR}</td>
                        <td class="zone1">${zone1Min} - ${zone1Max}</td>
                        <td class="zone2">${zone2Min} - ${zone2Max}</td>
                        <td class="zone3">${zone3Min} - ${zone3Max}</td>
                        <td class="zone4">${zone4Min} - ${zone4Max}</td>
                        <td class="zone5">${zone5Min} - ${zone5Max}</td>
                    `;
                    tableBody.appendChild(row);
                }
            }
        }

        // Populate table when page loads
        document.addEventListener('DOMContentLoaded', function() {
            populateTable();
            updateFormulaDescription();
            toggleZoneMethod(); // Initialize zone method display
        });

        // Allow Enter key to calculate
        document.getElementById('age').addEventListener('keypress', function(e) {
            if (e.key === 'Enter') {
                calculateHeartRate();
            }
        });
        
        document.getElementById('formula').addEventListener('change', function(e) {
            updateFormulaDescription();
            populateTable(); // Repopulate table with new formula
            if (e.target.value && document.getElementById('age').value) {
                const needsSex = e.target.value === 'wingate';
                if (!needsSex || document.getElementById('sex').value) {
                    calculateHeartRate();
                }
            }
        });
        
        document.getElementById('sex').addEventListener('change', function(e) {
            if (e.target.value && document.getElementById('age').value) {
                calculateHeartRate();
            }
        });
        
        document.getElementById('age').addEventListener('input', function(e) {
            // Age input event - no action needed for current zones
        });

        // Heart Rate Zones Calculator Event Listeners
        document.getElementById('zoneMethod').addEventListener('change', toggleZoneMethod);
        
        document.getElementById('maxHR').addEventListener('keypress', function(e) {
            if (e.key === 'Enter') {
                calculateZones();
            }
        });
        
        document.getElementById('karvonenMaxHR').addEventListener('keypress', function(e) {
            if (e.key === 'Enter') {
                calculateZones();
            }
        });
        
        document.getElementById('restHR').addEventListener('keypress', function(e) {
            if (e.key === 'Enter') {
                calculateZones();
            }
        });
    </script>
</body>
</html>
